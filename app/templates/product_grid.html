<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disc Golf Master</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">

    <style>

        body {
            font-family: 'Roboto', serif;
            position: relative;
            background-image: url('https://www.innovadiscs.com/wp-content/uploads/2015/06/disc-golf-beauty.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            padding: 20px;
            min-height: 100vh;
            box-sizing: border-box;
            margin: 0;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.65);
            z-index: -1;
        }

        h1 {
            text-align: left;
            color: white;
            margin-bottom: 20px;
        }

        .main-container {
            display: flex;
            gap: 20px;
        }

        .sidebar {
            width: 250px;
            background-color: #fff;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }

        .sidebar input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .sidebar input[type="checkbox"]:hover {
            transform: scale(1.3);
        }

        .search-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        input[type="text"], select {
            width: 100%;
            padding: 12px;
            font-size: 1em;
            border: 1px solid #ccc;
            border-radius: 20px;
            box-sizing: border-box;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            background-color: #f9f9f9;
        }


        input[type="text"]:hover, select:hover {
            border-color: #228B22;
            background-color: #f0f0f0;
        }


        input[type="text"]:focus, select:focus {
            outline: none;
            border-color: #006400; 
            box-shadow: 0px 0px 5px rgba(0, 100, 0, 0.5);
        }

        button {
            background: linear-gradient(135deg, #228B22 0%, #006400 100%);
            border: none;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            font-size: 1em;
            cursor: pointer;
            border-radius: 20px;
            transition: all 0.3s ease;
            box-shadow: 0px 4px 10px rgba(34, 139, 34, 0.4);
        }

        button:hover {
            background: linear-gradient(135deg, #006400 0%, #004d00 100%);
            transform: scale(1.03);
            box-shadow: 0px 8px 15px rgba(0, 100, 0, 0.6);
        }

        button:focus {
            outline: none;
            box-shadow: 0px 0px 0px 4px rgba(34, 139, 34, 0.4);
        }

        .container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            flex-grow: 1;
        }

        .card {
            background-color: white;
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 20px;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: space-between; /* Aligns content at the top */
            align-items: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            min-height: 450px;
            overflow: hidden;
            background: linear-gradient(135deg, #fff, #f4f4f4);
        }

        .card:hover {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
            transform: translateY(-10px);
        }

        .card img {
            width: 80%; /* Or use a specific pixel width like 280px to maintain uniformity */
            max-width: 280px; /* Maximum width to ensure consistency across different images */
            height: 200px; /* Fixed height */
            object-fit: contain; /* Ensures the image fits within the box without cropping */
            object-position: center; /* Centers the image within the container */
            border-radius: 10px;
            margin-bottom: 15px;
            transition: transform 0.3s ease;
            background-color: #f0f0f0; /* Optional: add a background color to fill space where the image doesn't cover */
        }

        .card:hover img {
            transform: scale(1.05);
        }

        .card h2 {
            font-family: 'Barlow', sans-serif;
            font-size: 1.4em;
            font-weight: 500;
            margin: 15px 0 10px 0;
            color: #333;
            max-height: 3em;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            transition: color 0.3s ease-in-out;
        }

        .card:hover h2 {
            color: #007bff;
        }

        .card p {
            margin: 0;
            font-style: italic;
            color: #666;
            font-size: 0.95em;
            line-height: 1.4;
            max-height: 4em;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            font-size: 20px;
        }

        .card .btn {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border-radius: 18px;
            border: none;
            font-size: 1em;
            margin-top: 20px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.3s ease;
        }

        .card .btn:hover {
            background-color: #0056b3;
            transform: scale(1.05);
        }

        .card h2, .card p {
            width: 100%; /* Ensure they're full width */
            flex-shrink: 0; /* Prevent text from shrinking */
        }

        .card:hover img {
            transform: scale(1.05);
        }

        .card:hover {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
            transform: translateY(-10px);
        }

        .flight-ratings {
            margin-top: 10px;
            font-size: 0.85em;
            color: #555;
            line-height: 1.4em;
            height: 3em;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;    
            -webkit-box-orient: vertical;
        }

        a.card-link {
            text-decoration: none;
            color: inherit;  
            display: block;  
        }

        select {
            width: 100%;
            padding: 12px;
            font-size: 1em;
            border: 1px solid #ccc;
            border-radius: 20px;
            box-sizing: border-box;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            background-color: #f9f9f9;
        }

        select:hover {
            border-color: #228B22;
            background-color: #f0f0f0;
        }

        select:focus {
            outline: none;
            border-color: #006400;
            box-shadow: 0px 0px 5px rgba(0, 100, 0, 0.5);
        }

        .pagination-container {
            text-align: center;
            padding: 50px;
            position: absolute;
        }

        .pagination {
            display: inline-block;
        }

        .pagination-link {
            color: #2e7d32;
            padding: 8px 16px;
            text-decoration: none;
            border: 1px solid #81c784;
            margin: 0 2px;
            border-radius: 4px;
            background-color: #e8f5e9;
            transition: background-color 0.3s;
        }

        .pagination-link:hover {
            background-color: #c8e6c9;
            cursor: pointer;
        }

        .pagination-link.current {
            background-color: #81c784;
            color: white;
            border-color: #66bb6a;
        }

        .pagination-link.disabled {
            color: #9e9e9e;
            pointer-events: none;
        }

        @media (max-width: 600px) {
            .pagination-link {
                padding: 3px 6px; 
                font-size: 0.8em;  
            }

            .pagination-link:hover {
                background-color: #dcedc8; 
            }

            .pagination-link.current {
                background-color: #a5d6a7; 
                border-color: #81c784; 
            }
        }

        .current-page {
            font-weight: bold;
            color: #333; 
        }

        #infoBackdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease-out;
            z-index: 5;
        }

        #infoBackdrop.active {
            display: flex;
            opacity: 1;
        }

        .popupContent {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            position: relative;
            transform: translateY(100%); /* Start from bottom */
            transition: transform 0.3s ease-out;
        }

        #infoBackdrop.active .popupContent {
            transform: translateY(0); /* Move to center */
        }

        #popupClose {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            cursor: pointer;
        }

    </style>

</head>

<body>

    <h1>Disc Golf Master</h1>

    <button id="infoButton", style="margin-bottom: 20px;">Information</button>
    <div id="infoBackdrop" class="hidden">
        <div id="infoPopup" class="popupContent">
            <span id="popupClose">&times;</span>
            <h3>Information</h3>
            <p>This page is part of a project at LUT University, within the scope of the CT70A9800 Full Stack Development course.</p>
        </div>
    </div>
    
    <div class="main-container">

        <aside class="sidebar">

            <div class="search-container">
                
                <form action="/products" method="get">
                    <h3>Search:</h3>
                    <input type="text" name="search" placeholder="Search for products..." value="{{ search_query }}">
                    <button type="submit">Search</button>
                </form>

                <form action="/products" method="get" id="filter-form">

                    <h3>Sort By:</h3>
                    <select name="sort" onchange="this.form.submit()">
                        <option value="">Select Sort Option</option>
                        <option value="price" {% if sort_option == 'price' %} selected {% endif %}>Price</option>
                        <option value="title" {% if sort_option == 'title' %} selected {% endif %}>Title</option>
                    </select>
                    
                    <h3>Filter:</h3>
                    <select name="price_range" onchange="this.form.submit()">
                        <option value="">Select Price Range</option>
                        <option value="5-10" {% if selected_price_range == '5-10' %} selected {% endif %}>€5 to €10</option>
                        <option value="10-15" {% if selected_price_range == '10-15' %} selected {% endif %}>€10 to €15</option>
                        <option value="15-20" {% if selected_price_range == '15-20' %} selected {% endif %}>€15 to €20</option>
                        <option value="20-25" {% if selected_price_range == '20-25' %} selected {% endif %}>€20 to €25</option>
                        <option value="25-30" {% if selected_price_range == '25-30' %} selected {% endif %}>€25 to €30</option>
                        <option value="30-35" {% if selected_price_range == '30-35' %} selected {% endif %}>€30 to €35</option>
                        <option value="35-40" {% if selected_price_range == '35-40' %} selected {% endif %}>€35 to €40</option>
                        <option value="40-45" {% if selected_price_range == '40-45' %} selected {% endif %}>€40 to €45</option>
                        <option value="45-50" {% if selected_price_range == '45-50' %} selected {% endif %}>€45 to €50</option>
                    </select>
                    <select name="speed" onchange="this.form.submit()">
                        <option value="">Select Speed</option>
                        <option value="1" {% if selected_speed == '1' %} selected {% endif %}>Speed 1</option>
                        <option value="2" {% if selected_speed == '2' %} selected {% endif %}>Speed 2</option>
                        <option value="3" {% if selected_speed == '3' %} selected {% endif %}>Speed 3</option>
                        <option value="4" {% if selected_speed == '4' %} selected {% endif %}>Speed 4</option>
                        <option value="5" {% if selected_speed == '5' %} selected {% endif %}>Speed 5</option>
                        <option value="6" {% if selected_speed == '6' %} selected {% endif %}>Speed 6</option>
                        <option value="7" {% if selected_speed == '7' %} selected {% endif %}>Speed 7</option>
                        <option value="8" {% if selected_speed == '8' %} selected {% endif %}>Speed 8</option>
                        <option value="9" {% if selected_speed == '9' %} selected {% endif %}>Speed 9</option>
                        <option value="10" {% if selected_speed == '10' %} selected {% endif %}>Speed 10</option>
                        <option value="11" {% if selected_speed == '11' %} selected {% endif %}>Speed 11</option>
                        <option value="12" {% if selected_speed == '12' %} selected {% endif %}>Speed 12</option>
                        <option value="13" {% if selected_speed == '13' %} selected {% endif %}>Speed 13</option>
                        <option value="14" {% if selected_speed == '14' %} selected {% endif %}>Speed 14</option>
                    </select>
                    <select name="glide" onchange="this.form.submit()">
                        <option value="">Select Glide</option>
                        <option value="1" {% if selected_glide == '1' %} selected {% endif %}>Glide 1</option>
                        <option value="2" {% if selected_glide == '2' %} selected {% endif %}>Glide 2</option>
                        <option value="3" {% if selected_glide == '3' %} selected {% endif %}>Glide 3</option>
                        <option value="4" {% if selected_glide == '4' %} selected {% endif %}>Glide 4</option>
                        <option value="5" {% if selected_glide == '5' %} selected {% endif %}>Glide 5</option>
                        <option value="6" {% if selected_glide == '6' %} selected {% endif %}>Glide 6</option>
                        <option value="7" {% if selected_glide == '7' %} selected {% endif %}>Glide 7</option>
                    </select>
                    <select name="turn" onchange="this.form.submit()">
                        <option value="">Select Turn</option>
                        <option value="-5" {% if selected_turn == '-5' %} selected {% endif %}>Turn -5</option>
                        <option value="-4" {% if selected_turn == '-4' %} selected {% endif %}>Turn -4</option>
                        <option value="-3" {% if selected_turn == '-3' %} selected {% endif %}>Turn -3</option>
                        <option value="-2" {% if selected_turn == '-2' %} selected {% endif %}>Turn -2</option>
                        <option value="-1" {% if selected_turn == '-1' %} selected {% endif %}>Turn -1</option>
                        <option value="0" {% if selected_turn == '0' %} selected {% endif %}>Turn 0</option>
                        <option value="1" {% if selected_turn == '1' %} selected {% endif %}>Turn 1</option>
                    </select>
                    <select name="fade" onchange="this.form.submit()">
                        <option value="">Select Fade</option>
                        <option value="0" {% if selected_fade == '0' %} selected {% endif %}>Fade 0</option>
                        <option value="1" {% if selected_fade == '1' %} selected {% endif %}>Fade 1</option>
                        <option value="2" {% if selected_fade == '2' %} selected {% endif %}>Fade 2</option>
                        <option value="3" {% if selected_fade == '3' %} selected {% endif %}>Fade 3</option>
                        <option value="4" {% if selected_fade == '4' %} selected {% endif %}>Fade 4</option>
                        <option value="5" {% if selected_fade == '5' %} selected {% endif %}>Fade 5</option>
                    </select>
                
                    <h3>Select Store:</h3>
                    <div style="margin-bottom: 10px;">
                        {% for store in unique_stores %}
                            <label>
                                <input type="checkbox" name="store" value="{{ store }}" 
                                {% if store in selected_stores %} checked {% endif %} 
                                onchange="this.form.submit()"> {{ store }}
                            </label><br>
                        {% endfor %}
                    </div>
                </form>

            </div>
        </aside>

        <div class="container" id="container1">
            {% for product in products %}
            <a href="{{ product.link_to_disc }}" class="card-link">
                <div class="card">
        
                    <img src="{{ product.image_url }}" alt="{{ product.title }}" onerror="this.src='/static/placeholder.jpg';">
                    <h2>{{ product.title }}</h2>
                    <p>Price: {{ product.price }}{{ product.currency }}</p>
        
                    {% if product.speed is not none or product.glide is not none or product.turn is not none or product.fade is not none %}
                    <div class="flight-ratings">
                        <strong>Flight Ratings:</strong><br>
                        Speed: <span class="speed">{{ product.speed if product.speed is not none else 'N/A' }}</span>, 
                        Glide: <span class="glide">{{ product.glide if product.glide is not none else 'N/A' }}</span>, 
                        Turn: <span class="turn">{{ product.turn if product.turn is not none else 'N/A' }}</span>, 
                        Fade: <span class="fade">{{ product.fade if product.fade is not none else 'N/A' }}</span>
                    </div>
                    {% endif %}
                    
                </div>
            </a>
            {% endfor %}
        </div>
        
    </div>

    <div class="pagination-container" id="container2">
        <div class="pagination">
            {% if page > 1 %}
                <a href="{{ url_for('product_grid', **dict(request.args, page=page-1)) }}" class="pagination-link">« Previous</a>
            {% endif %}
    
            {% for p in pages_to_display %}
                {% if p == page %}
                    <span class="pagination-link current">{{ p }}</span>
                {% else %}
                    <a href="{{ url_for('product_grid', **dict(request.args, page=p)) }}" class="pagination-link">{{ p }}</a>
                {% endif %}
            {% endfor %}
    
            {% if page < total_pages %}
                <a href="{{ url_for('product_grid', **dict(request.args, page=page+1)) }}" class="pagination-link">Next »</a>
            {% endif %}
        </div>
    </div>

    <script>
        function centerContainer2() {
            const container1 = document.getElementById('container1');
            const container2 = document.getElementById('container2');

            const rect1 = container1.getBoundingClientRect();

            const centerX = rect1.left + rect1.width / 2;

            const container2Width = container2.offsetWidth;
            container2.style.left = `${centerX - container2Width / 2}px`;
        }

        window.onload = centerContainer2;
        window.onresize = centerContainer2;
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const products = {{ products | tojson | safe }};

            function formatNumber(number) {
                if (number === null || number === undefined) {
                    return "N/A"; 
                }
                return number % 1 === 0 ? number.toFixed(0) : number.toFixed(1);
            }

            Array.from(document.querySelectorAll('.card')).forEach((card, index) => {
                const product = products[index];

                if (product) {
                    const speedElem = card.querySelector('.speed');
                    const glideElem = card.querySelector('.glide');
                    const turnElem = card.querySelector('.turn');
                    const fadeElem = card.querySelector('.fade');

                    if (speedElem) speedElem.textContent = formatNumber(product.speed);
                    if (glideElem) glideElem.textContent = formatNumber(product.glide);
                    if (turnElem) turnElem.textContent = formatNumber(product.turn);
                    if (fadeElem) fadeElem.textContent = formatNumber(product.fade);
                }
            });
        });
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const infoButton = document.getElementById('infoButton');
            const infoBackdrop = document.getElementById('infoBackdrop');
            const popupClose = document.getElementById('popupClose');

            infoButton.addEventListener('click', () => {
                infoBackdrop.classList.add('active');
                document.body.style.overflow = 'hidden'; // Disable scrolling
            });

            popupClose.addEventListener('click', () => {
                infoBackdrop.classList.remove('active');
                setTimeout(() => {
                    document.body.style.overflow = ''; // Enable scrolling
                }, 300); // Match this duration with the CSS transition time
            });

            // Optional: Close the popup when clicking outside of it
            infoBackdrop.addEventListener('click', (event) => {
                if (event.target === infoBackdrop) {
                    popupClose.click();
                }
            });
        });
    </script>

</body>
</html>